# Roadmap (Avro / Schema Registry)

## 1. Введение

В рамках развития проекта планируется интеграция формата Avro и использование Schema Registry для управления схемами данных. Это позволит повысить надежность и гибкость обработки сообщений, а также упростить поддержку и эволюцию схем.

## 2. Текущее состояние (JSON Schema)

На данный момент в проекте реализована поддержка JSON Schema для валидации и управления схемами сообщений. Для этого используются следующие классы:

- `JsonSchemaRegistry.java` — класс, отвечающий за работу с JSON Schema.
- `SchemaRegistry.java` — абстрактный класс/интерфейс, определяющий общий контракт для работы с реестром схем.

Данный подход позволяет валидировать сообщения на основе JSON Schema, что обеспечивает базовую проверку корректности данных.

## 3. Ограничения текущего подхода

Использование JSON Schema имеет ряд ограничений:

- Отсутствие строгой типизации и компактности формата, что влияет на производительность.
- Ограниченные возможности по управлению версиями и эволюцией схем.
- Сложности с интеграцией в экосистему Kafka и другими инструментами, которые активно используют Avro и Schema Registry.

Эти ограничения мотивируют переход к более современному и мощному решению на базе Avro.

## 4. План перехода на Avro/Schema Registry

Переход на Avro и Schema Registry предусматривает следующие шаги:

- Добавление поддержки формата Avro для сериализации и десериализации сообщений.
- Интеграция с внешним Schema Registry (например, Confluent Schema Registry) для централизованного управления схемами.
- Обеспечение совместимости и миграции существующих схем JSON Schema в Avro.
- Обновление компонентов проекта для работы с новым форматом и реестром схем.

Это позволит повысить надежность, обеспечить строгую типизацию, а также упростить сопровождение и масштабирование системы.

## 5. Необходимые изменения в коде (ссылки на классы)

Для реализации поддержки Avro и Schema Registry планируется:

- Создать новый класс `AvroSchemaRegistry.java`, который будет реализовывать интерфейс `SchemaRegistry.java` и обеспечивать взаимодействие с Avro и внешним Schema Registry.
- Расширить существующие механизмы сериализации/десериализации для поддержки Avro.
- Обновить конфигурацию и документацию с учетом новых возможностей.

Текущие классы, связанные с управлением схемами:

- `JsonSchemaRegistry.java` — работа с JSON Schema.
- `SchemaRegistry.java` — общий интерфейс/абстракция для реестра схем.

## 6. Roadmap (этапы внедрения)

1. Анализ и проектирование архитектуры интеграции Avro и Schema Registry.
2. Разработка класса `AvroSchemaRegistry.java` и реализация базовой поддержки Avro.
3. Интеграция с внешним Schema Registry и настройка взаимодействия.
4. Обновление механизмов сериализации/десериализации для работы с Avro.
5. Тестирование и валидация новой функциональности.
6. Миграция существующих схем и данных.
7. Обновление документации и обучение команды.

Данный план позволит постепенно и контролируемо внедрить поддержку Avro и Schema Registry в проект, обеспечив при этом совместимость и стабильность работы.

---

## Связанные файлы в коде

- `SchemaRegistry.java` — базовый контракт реестра схем (интерфейс).
- `JsonSchemaRegistry.java` — текущая реализация на основе единого файла `schema.json`.
- *(план)* `AvroSchemaRegistry.java` — реализация для Avro + внешнего Schema Registry (этапы см. выше).
